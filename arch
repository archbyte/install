#!/bin/bash
echo
#------------------------------------------------------------------------------------------------------------------------------------------
if [[ $EUID -ne 0 ]]; then
    echo "You must be a root user to run this." 2>&1
    exit 1
fi
#------------------------------------------------------------------------------------------------------------------------------------------
echo "ls /sys/firmware/efi/efivars"
ls /sys/firmware/efi/efivars
echo
echo "Press 'Ctrl+c' to exit OR 'Enter' to continue"
read
#------------------------------------------------------------------------------------------------------------------------------------------
fdisk -l
echo
#------------------------------------------------------------------------------------------------------------------------------------------
lsblk
echo
#------------------------------------------------------------------------------------------------------------------------------------------
echo "cfdisk"
read
cfdisk
#------------------------------------------------------------------------------------------------------------------------------------------
fdisk -l
echo
lsblk
#------------------------------------------------------------------------------------------------------------------------------------------
echo "cfdisk"
read
cfdisk
#------------------------------------------------------------------------------------------------------------------------------------------
fdisk -l
lsblk
echo
#------------------------------------------------------------------------------------------------------------------------------------------
#read -p "efipartition (/dev/sdax) = " efipartition
#echo $efipartition
#echo
#read -p "ospartition (/dev/sdax) = " ospartition
#echo $ospartition
#echo
#------------------------------------------------------------------------------------------------------------------------------------------
#echo mkfs.fat -F32 $efipartition
#mkfs.fat -F32 $efipartition
#echo
#------------------------------------------------------------------------------------------------------------------------------------------
#echo mkfs.ext4 $ospartition
#mkfs.ext4 $ospartition
#echo
#------------------------------------------------------------------------------------------------------------------------------------------
read -p "rootpartition(bootable) (/dev/sdax) = " rootpartition
echo $rootpartition
echo
#------------------------------------------------------------------------------------------------------------------------------------------
echo mkfs.ext4 $rootpartition
mkfs.ext4 $rootpartition
echo

#------------------------------------------------------------------------------------------------------------------------------------------
mount $rootpartition /mnt
#------------------------------------------------------------------------------------------------------------------------------------------
echo "pacstrap /mnt base base-devel"
pacstrap /mnt base base-devel
echo
#------------------------------------------------------------------------------------------------------------------------------------------
echo "Generate fstab."
genfstab -U /mnt >> /mnt/etc/fstab
echo
cat /mnt/etc/fstab
#------------------------------------------------------------------------------------------------------------------------------------------
cp /root/install/chroot /mnt
cp /root/install/de /mnt
chmod +x /mnt/chroot
chmod +x /mnt/de
rm -r /root/install
#------------------------------------------------------------------------------------------------------------------------------------------
#mkdir /mnt/hostlvm
#mount --bind /run/lvm /mnt/hostlvm
#------------------------------------------------------------------------------------------------------------------------------------------
echo "arch-chroot /mnt"
arch-chroot /mnt
