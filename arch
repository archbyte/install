#!/bin/bash
echo
#------------------------------------------------------------------------------------------------------------------------------------------
if [[ $EUID -ne 0 ]]; then
    echo "You must be a root user to run this." 2>&1
    exit 1
fi
#------------------------------------------------------------------------------------------------------------------------------------------
echo "ls /sys/firmware/efi/efivars - should not see directories"
ls /sys/firmware/efi/efivars
timedatectl set-ntp true
echo
echo "Press 'Ctrl+c' to exit OR 'Enter' to continue"
read
#------------------------------------------------------------------------------------------------------------------------------------------
fdisk -l
echo
#------------------------------------------------------------------------------------------------------------------------------------------
lsblk
echo
#------------------------------------------------------------------------------------------------------------------------------------------
echo "cfdisk"
read
cfdisk
#------------------------------------------------------------------------------------------------------------------------------------------
lsblk
#------------------------------------------------------------------------------------------------------------------------------------------
echo "cfdisk"
read
cfdisk
#------------------------------------------------------------------------------------------------------------------------------------------
fdisk -l
lsblk
echo
#------------------------------------------------------------------------------------------------------------------------------------------
read -p "rootpartition(bootable) (/dev/sdax) = " rootpartition
echo $rootpartition
echo
read -p "swappartition (/dev/sdax) = " swappartition
echo $swappartition
echo
#------------------------------------------------------------------------------------------------------------------------------------------
echo mkfs.ext4 $rootpartition
mkfs.ext4 $rootpartition
echo
#------------------------------------------------------------------------------------------------------------------------------------------
echo mkswap $swappartition
echo swapon $swappartition
mkswap $swappartition
swapon $swappartition
echo
#------------------------------------------------------------------------------------------------------------------------------------------
fdisk -l
echo
#------------------------------------------------------------------------------------------------------------------------------------------
echo mount $rootpartition /mnt
mount $rootpartition /mnt
echo
#------------------------------------------------------------------------------------------------------------------------------------------
echo "pacstrap /mnt base base-devel"
pacstrap /mnt base base-devel
echo
#------------------------------------------------------------------------------------------------------------------------------------------
echo "Generate fstab."
genfstab -U /mnt >> /mnt/etc/fstab
echo
cat /mnt/etc/fstab
#------------------------------------------------------------------------------------------------------------------------------------------
cp /root/install/chroot /mnt
cp /root/install/de /mnt
chmod +x /mnt/chroot
chmod +x /mnt/de
rm -r /root/install
#------------------------------------------------------------------------------------------------------------------------------------------
echo "arch-chroot /mnt"
arch-chroot /mnt
